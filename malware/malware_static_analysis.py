from dataclasses import dataclass, asdict
import pprint
import hashlib
import os
import pefile

@dataclass
class FileInfo:
    md5_hash: str = ""
    file_size: str = ""
    file_version: str = ""
    product_version: str = ""


def make_version(version_ms, version_ls):
    version = str(version_ms >> 16) + "." + str(version_ms & 0xFFFF) + "." + str(version_ls >> 16) + "." + str(version_ls & 0xFFFF)

    return version

file_info = FileInfo()

file_size = os.path.getsize('C:\\Users\\sukim\\AppData\\Local\\Programs\\Python\\Python39\\python.exe')
file_size = str(round(file_size / 1024)) + " KByte"

pe = pefile.PE('C:\\Users\\sukim\\AppData\\Local\\Programs\\Python\\Python39\\python.exe')
version_info = pe.VS_FIXEDFILEINFO[0]

file_version_ls = version_info.FileVersionLS
file_version_ms = version_info.FileVersionMS
product_version_ls = version_info.ProductVersionLS
product_version_ms = version_info.ProductVersionMS

file_version = make_version(file_version_ms, file_version_ls)
product_version = make_version(product_version_ms, product_version_ls)

f = open('C:\\Users\\sukim\\AppData\\Local\\Programs\\Python\\Python39\\python.exe', 'rb')
file_data = f.read()
f.close()

file_info.md5_hash = hashlib.md5(file_data).hexdigest()
file_info.file_size = file_size
file_info.file_version = str(file_version)
file_info.product_version = str(product_version)

pp = pprint.PrettyPrinter(indent=4)
pp.pprint(asdict(file_info))